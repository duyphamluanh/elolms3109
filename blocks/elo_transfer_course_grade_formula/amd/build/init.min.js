/*
 * Javascript needed for license tool datatables
 * 
 * @package    block_elo_reports_log_bbb
 * @copyright  2018 Kentucky Educational Television
 */

define(['jquery',
    'core/ajax', 'core/str', 'core/notification', 'core/modal_factory', 'core/modal_events', 'core/templates'
], function ($,Ajax, Str, Notification, ModalFactory, ModalEvents, Templates) {

    /**
     * Selectors.
     *
     * @access private
     * @type {Object}
     */
    var SELECTORS = {
        BUTTON_TRANFERS_COURCES: '#btntransfer',
        BULKACTIONFORM: '#bercourseslmsform',
        TRANSFERCOURSESID: '#bercourseid',
        ORIGINCOURSEID: '#orgcourseid'
    };
    return {
        init: function (identifier, config) {
            $(document).ready(function () {
                var valueorgcourse,valuetransfercourse;
                var orgcourseinput = $(SELECTORS.BULKACTIONFORM + ' [name=orgcourseid]');
                var transfercoursesinput = $(SELECTORS.BULKACTIONFORM + ' [name=transfercoursesid]');

                $(SELECTORS.BUTTON_TRANFERS_COURCES).on('click', function () {

                    valueorgcourse = $(SELECTORS.ORIGINCOURSEID).val();
                    valuetransfercourse = $(SELECTORS.TRANSFERCOURSESID).val();
                    
                    if (valueorgcourse.length >= 1) {
                        var params = Array.from(document.getElementById("orgcourseid").options).filter(option => option.selected).map(option => option.value);
                        orgcourseinput.val(params.toString());
                        
                        if (valuetransfercourse.length >= 1) {
                            var params = Array.from(document.getElementById("bercourseid").options).filter(option => option.selected).map(option => option.value);
                            transfercoursesinput.val(params.toString());
                            $(SELECTORS.BULKACTIONFORM).submit();
                        } else {
                            Notification.alert(
                                    null, 'Bạn chưa chọn lớp cần dịch chuyển !'
                                    );
                            return;
                        }

                    } else {
                        Notification.alert(
                                null, 'Bạn chưa chọn lớp môn học gốc !'
                                );
                        return;
                    }
                    
                }.bind(this));
            });
        }
    };
});
